<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>凡人修仙挂机版</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e0e0e0;
            overflow-x: hidden;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        h1 { text-align: center; color: #ffd700; text-shadow: 0 0 20px rgba(255,215,0,0.5); margin-bottom: 20px; font-size: 2.5em; }
        .main-grid { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin-bottom: 20px; }
        .panel { background: rgba(0,0,0,0.4); border-radius: 15px; padding: 20px; border: 1px solid rgba(255,215,0,0.2); backdrop-filter: blur(10px); }
        .panel h2 { color: #ffd700; margin-bottom: 15px; font-size: 1.2em; border-bottom: 2px solid rgba(255,215,0,0.3); padding-bottom: 10px; }
        .stat-row { display: flex; justify-content: space-between; margin: 10px 0; padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px; }
        .stat-label { color: #aaa; }
        .stat-value { color: #fff; font-weight: bold; }
        .stat-value.hp { color: #ff6b6b; }
        .stat-value.mp { color: #4ecdc4; }
        .stat-value.exp { color: #ffd93d; }
        .realm { text-align: center; padding: 15px; background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,140,0,0.2)); border-radius: 10px; margin-bottom: 15px; }
        .realm-name { font-size: 1.5em; color: #ffd700; font-weight: bold; }
        .realm-stage { color: #ff8c00; margin-top: 5px; }
        .progress-bar { width: 100%; height: 20px; background: rgba(0,0,0,0.5); border-radius: 10px; overflow: hidden; margin: 10px 0; position: relative; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #ffd700, #ff8c00); transition: width 0.3s; border-radius: 10px; }
        .progress-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 12px; color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); }
        .enemy { text-align: center; padding: 30px; background: rgba(255,0,0,0.1); border-radius: 15px; margin-bottom: 20px; border: 2px solid rgba(255,100,100,0.3); }
        .enemy-name { font-size: 1.8em; color: #ff6b6b; margin-bottom: 10px; }
        .enemy-hp-bar { width: 100%; height: 30px; background: rgba(0,0,0,0.5); border-radius: 15px; overflow: hidden; margin: 15px 0; }
        .enemy-hp-fill { height: 100%; background: linear-gradient(90deg, #ff4444, #ff8888); transition: width 0.2s; }
        .combat-log { height: 200px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; font-size: 14px; line-height: 1.6; }
        .log-entry { margin: 5px 0; padding: 5px; border-radius: 5px; }
        .log-damage { color: #ff6b6b; }
        .log-heal { color: #4ecdc4; }
        .log-loot { color: #ffd93d; }
        .log-level { color: #a8e6cf; }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; transition: all 0.3s; margin: 5px; font-weight: bold; }
        .btn-primary { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(102,126,234,0.4); }
        .btn-success { background: linear-gradient(135deg, #11998e, #38ef7d); color: white; }
        .btn-danger { background: linear-gradient(135deg, #eb3349, #f45c43); color: white; }
        .tabs { display: flex; gap: 10px; margin-bottom: 15px; }
        .tab { padding: 10px 20px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .tab.active { background: rgba(255,215,0,0.3); color: #ffd700; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .inventory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .item { aspect-ratio: 1; background: rgba(255,255,255,0.1); border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 12px; }
        .skills-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; }
        .skill { padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; text-align: center; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; }
        .skill:hover { background: rgba(255,255,255,0.2); }
        .skill.active { border-color: #ffd700; background: rgba(255,215,0,0.2); }
        .skill-name { font-weight: bold; color: #ffd700; margin-bottom: 5px; }
        @media (max-width: 900px) { .main-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>?? 凡人修仙挂机版</h1>
        <div class="main-grid">
            <div class="panel">
                <h2>?? 角色状态</h2>
                <div class="realm">
                    <div class="realm-name" id="realmName">炼气期</div>
                    <div class="realm-stage" id="realmStage">第一层</div>
                </div>
                <div class="stat-row"><span class="stat-label">生命值</span><span class="stat-value hp" id="hp">100/100</span></div>
                <div class="progress-bar"><div class="progress-fill" id="hpBar" style="width: 100%"></div></div>
                <div class="stat-row"><span class="stat-label">法力值</span><span class="stat-value mp" id="mp">50/50</span></div>
                <div class="progress-bar"><div class="progress-fill" id="mpBar" style="width: 100%; background: linear-gradient(90deg, #4ecdc4, #44a3aa);"></div></div>
                <div class="stat-row"><span class="stat-label">修为</span><span class="stat-value exp" id="exp">0/100</span></div>
                <div class="progress-bar"><div class="progress-fill" id="expBar" style="width: 0%"></div><div class="progress-text" id="expText">0%</div></div>
                <div class="stat-row"><span class="stat-label">攻击力</span><span class="stat-value" id="atk">10</span></div>
                <div class="stat-row"><span class="stat-label">防御力</span><span class="stat-value" id="def">5</span></div>
                <div class="stat-row"><span class="stat-label">暴击率</span><span class="stat-value" id="crit">5%</span></div>
                <div class="stat-row"><span class="stat-label">灵石</span><span class="stat-value" id="spiritStones" style="color: #ffd700;">0</span></div>
            </div>
            <div class="panel">
                <h2>?? 修炼战斗</h2>
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('battle')">战斗</div>
                    <div class="tab" onclick="switchTab('skills')">功法</div>
                    <div class="tab" onclick="switchTab('inventory')">背包</div>
                </div>
                <div class="tab-content active" id="tab-battle">
                    <div class="enemy" id="enemyArea">
                        <div class="enemy-name" id="enemyName">野狼</div>
                        <div style="color: #aaa; margin-bottom: 10px;" id="enemyDesc">凡间野兽，适合新手练手</div>
                        <div class="enemy-hp-bar"><div class="enemy-hp-fill" id="enemyHpBar" style="width: 100%"></div></div>
                        <div style="color: #ff6b6b;" id="enemyHp">50/50</div>
                    </div>
                    <div style="text-align: center; margin: 20px 0;">
                        <button class="btn btn-primary" id="battleBtn" onclick="toggleBattle()">开始修炼</button>
                        <button class="btn btn-success" onclick="manualAttack()">手动攻击</button>
                    </div>
                    <div class="combat-log" id="combatLog"><div class="log-entry">欢迎来到凡人修仙世界！点击"开始修炼"自动战斗，或手动攻击。</div></div>
                </div>
                <div class="tab-content" id="tab-skills">
                    <div class="skills-grid" id="skillsGrid"></div>
                </div>
                <div class="tab-content" id="tab-inventory">
                    <div class="inventory-grid" id="inventory"></div>
                </div>
            </div>
            <div class="panel">
                <h2>?? 游戏说明</h2>
                <div style="font-size: 14px; line-height: 1.8; color: #aaa;">
                    <p><strong style="color: #ffd700;">修炼系统</strong></p>
                    <p>? 点击"开始修炼"自动战斗</p>
                    <p>? 击败敌人获得修为和材料</p>
                    <p>? 修为满后自动突破境界</p>
                    <br>
                    <p><strong style="color: #ffd700;">境界划分</strong></p>
                    <p>炼气→筑基→金丹→元婴→化神→炼虚→合体→大乘→渡劫→真仙</p>
                    <br>
                    <p><strong style="color: #ffd700;">功法升级</strong></p>
                    <p>? 消耗灵石提升功法等级</p>
                    <p>? 功法增强战斗属性</p>
                </div>
            </div>
        </div>
    </div>
    <script>
        const game = {
            player: { realm: 0, stage: 1, hp: 100, maxHp: 100, mp: 50, maxMp: 50, exp: 0, maxExp: 100, atk: 10, def: 5, crit: 5, spiritStones: 0, materials: {} },
            isBattling: false, battleInterval: null, currentEnemy: null,
            realms: ['炼气期', '筑基期', '金丹期', '元婴期', '化神期', '炼虚期', '合体期', '大乘期', '渡劫期', '真仙'],
            enemies: [
                { name: '野狼', hp: 50, atk: 8, exp: 10, stones: 2, desc: '凡间野兽', materials: { '狼牙': 0.3, '狼皮': 0.2 } },
                { name: '山贼', hp: 80, atk: 12, exp: 15, stones: 5, desc: '落草为寇的凡人', materials: { '铁矿': 0.4, '铜币': 0.5 } },
                { name: '妖兔', hp: 30, atk: 5, exp: 8, stones: 1, desc: '低阶妖兽', materials: { '妖核': 0.2, '兔毛': 0.4 } },
                { name: '毒蛇', hp: 60, atk: 15, exp: 18, stones: 4, desc: '带有剧毒', materials: { '毒囊': 0.3, '蛇胆': 0.2 } },
                { name: '铁背猿', hp: 120, atk: 20, exp: 30, stones: 8, desc: '皮糙肉厚的妖兽', materials: { '猿骨': 0.3, '铁背皮': 0.2 } }
            ],
            skills: [
                { id: 'basic', name: '基础剑诀', level: 1, maxLevel: 10, desc: '攻击+10%', cost: 50 },
                { id: 'breath', name: '吐纳术', level: 0, maxLevel: 10, desc: '生命+20%', cost: 50 },
                { id: 'body', name: '炼体术', level: 0, maxLevel: 10, desc: '防御+15%', cost: 50 },
                { id: 'spirit', name: '凝神诀', level: 0, maxLevel: 10, desc: '暴击+3%', cost: 50 },
                { id: 'speed', name: '疾风步', level: 0, maxLevel: 10, desc: '攻速+10%', cost: 50 }
            ]
        };

        function init() { updateUI(); renderSkills(); renderInventory(); spawnEnemy(); }
        function updateUI() {
            const p = game.player;
            document.getElementById('realmName').textContent = game.realms[p.realm];
            document.getElementById('realmStage').textContent = `第${p.stage}层`;
            document.getElementById('hp').textContent = `${Math.floor(p.hp)}/${p.maxHp}`;
            document.getElementById('mp').textContent = `${Math.floor(p.mp)}/${p.maxMp}`;
            document.getElementById('exp').textContent = `${Math.floor(p.exp)}/${p.maxExp}`;
            document.getElementById('atk').textContent = Math.floor(p.atk);
            document.getElementById('def').textContent = Math.floor(p.def);
            document.getElementById('crit').textContent = p.crit + '%';
            document.getElementById('spiritStones').textContent = p.spiritStones;
            document.getElementById('hpBar').style.width = (p.hp / p.maxHp * 100) + '%';
            document.getElementById('mpBar').style.width = (p.mp / p.maxMp * 100) + '%';
            document.getElementById('expBar').style.width = (p.exp / p.maxExp * 100) + '%';
            document.getElementById('expText').textContent = Math.floor(p.exp / p.maxExp * 100) + '%';
        }
        function spawnEnemy() {
            const template = game.enemies[Math.floor(Math.random() * game.enemies.length)];
            game.currentEnemy = { ...template, maxHp: template.hp, currentHp: template.hp };
            updateEnemyUI();
        }
        function updateEnemyUI() {
            const e = game.currentEnemy;
            document.getElementById('enemyName').textContent = e.name;
            document.getElementById('enemyDesc').textContent = e.desc;
            document.getElementById('enemyHp').textContent = `${Math.floor(e.currentHp)}/${e.maxHp}`;
            document.getElementById('enemyHpBar').style.width = (e.currentHp / e.maxHp * 100) + '%';
        }
        function toggleBattle() {
            const btn = document.getElementById('battleBtn');
            if (game.isBattling) { stopBattle(); btn.textContent = '开始修炼'; btn.className = 'btn btn-primary'; }
            else { startBattle(); btn.textContent = '停止修炼'; btn.className = 'btn btn-danger'; }
        }
        function startBattle() { game.isBattling = true; game.battleInterval = setInterval(battleTick, 1000); }
        function stopBattle() { game.isBattling = false; clearInterval(game.battleInterval); }
        function battleTick() {
            if (!game.currentEnemy || game.currentEnemy.currentHp <= 0) { spawnEnemy(); return; }
            const damage = calculateDamage();
            game.currentEnemy.currentHp -= damage;
            if (game.currentEnemy.currentHp <= 0) { enemyDefeated(); }
            else {
                const enemyDamage = Math.max(1, game.currentEnemy.atk - game.player.def * 0.5);
                game.player.hp -= enemyDamage;
                log(`受到 ${Math.floor(enemyDamage)} 点伤害`, 'damage');
                if (game.player.hp <= 0) { playerDefeated(); }
            }
            if (game.player.hp < game.player.maxHp) { game.player.hp = Math.min(game.player.maxHp, game.player.hp + game.player.maxHp * 0.02); }
            updateUI(); updateEnemyUI();
        }
        function calculateDamage() {
            let damage = game.player.atk;
            const skill = game.skills.find(s => s.id === 'basic');
            if (skill && skill.level > 0) damage *= (1 + skill.level * 0.1);
            if (Math.random() * 100 < game.player.crit) { damage *= 2; log('暴击！', 'damage'); }
            return Math.floor(damage);
        }
        function manualAttack() {
            if (!game.currentEnemy || game.currentEnemy.currentHp <= 0) spawnEnemy();
            const damage = calculateDamage() * 2;
            game.currentEnemy.currentHp -= damage;
            if (game.currentEnemy.currentHp <= 0) enemyDefeated();
            updateEnemyUI();
        }
        function enemyDefeated() {
            const e = game.currentEnemy;
            log(`击败了 ${e.name}！`, 'level');
            game.player.exp += e.exp;
            game.player.spiritStones += e.stones;
            log(`获得 ${e.exp} 修为，${e.stones} 灵石`, 'loot');
            for (const [material, chance] of Object.entries(e.materials)) {
                if (Math.random() < chance) {
                    game.player.materials[material] = (game.player.materials[material] || 0) + 1;
                    log(`获得 ${material}`, 'loot');
                }
            }
            if (game.player.exp >= game.player.maxExp) breakthrough();
            renderInventory(); updateUI(); spawnEnemy();
        }
        function playerDefeated() {
            stopBattle();
            log('你重伤倒地，被同门救回...', 'damage');
            game.player.hp = game.player.maxHp * 0.3;
            game.player.exp = Math.max(0, game.player.exp - 20);
            document.getElementById('battleBtn').textContent = '开始修炼';
            document.getElementById('battleBtn').className = 'btn btn-primary';
            updateUI();
        }
        function breakthrough() {
            game.player.exp -= game.player.maxExp;
            game.player.stage++;
            if (game.player.stage > 9) {
                game.player.stage = 1;
                game.player.realm++;
                game.player.maxExp *= 2;
                log(`突破！进入${game.realms[game.player.realm]}！`, 'level');
            } else {
                log(`突破至第${game.player.stage}层！`, 'level');
            }
            game.player.maxHp += 20; game.player.maxMp += 10;
            game.player.atk += 5; game.player.def += 3;
            game.player.hp = game.player.maxHp; game.player.mp = game.player.maxMp;
        }
        function renderSkills() {
            const grid = document.getElementById('skillsGrid');
            grid.innerHTML = '';
            game.skills.forEach(skill => {
                const div = document.createElement('div');
                div.className = `skill ${skill.level > 0 ? 'active' : ''}`;
                div.innerHTML = `<div class="skill-name">${skill.name}</div><div style="font-size:12px;color:#888;">Lv.${skill.level}/${skill.maxLevel}</div><div style="font-size:11px;color:#888;margin-top:5px;">${skill.desc}</div><div style="font-size:11px;color:#ffd700;margin-top:5px;">升级: ${skill.cost * (skill.level + 1)}灵石</div>`;
                div.onclick = () => upgradeSkill(skill);
                grid.appendChild(div);
            });
        }
        function upgradeSkill(skill) {
            if (skill.level >= skill.maxLevel) return;
            const cost = skill.cost * (skill.level + 1);
            if (game.player.spiritStones >= cost) {
                game.player.spiritStones -= cost;
                skill.level++;
                applySkillEffects();
                renderSkills();
                updateUI();
                log(`${skill.name} 提升至 Lv.${skill.level}`, 'level');
            } else {
                log('灵石不足！', 'damage');
            }
        }
        function applySkillEffects() {
            game.player.atk = 10 + game.player.realm * 10 + game.player.stage * 5;
            game.player.def = 5 + game.player.realm * 5 + game.player.stage * 3;
            game.player.crit = 5;
            game.skills.forEach(skill => {
                if (skill.level === 0) return;
                if (skill.id === 'basic') game.player.atk *= (1 + 0.1 * skill.level);
                if (skill.id === 'body') game.player.def *= (1 + 0.15 * skill.level);
                if (skill.id === 'spirit') game.player.crit += 3 * skill.level;
            });
        }
        function renderInventory() {
            const grid = document.getElementById('inventory');
            grid.innerHTML = '';
            for (const [name, count] of Object.entries(game.player.materials)) {
                const div = document.createElement('div');
                div.className = 'item';
                const icons = { '狼牙': '??', '狼皮': '??', '铁矿': '??', '铜币': '??', '妖核': '??', '兔毛': '??', '毒囊': '??', '蛇胆': '??', '猿骨': '??', '铁背皮': '???' };
                div.innerHTML = `<div style="font-size:24px;">${icons[name] || '??'}</div><div style="font-size:12px;margin-top:5px;">${name}</div><div style="font-size:12px;color:#ffd700;">${count}</div>`;
                grid.appendChild(div);
            }
        }
        function log(message, type) {
            const logDiv = document.getElementById('combatLog');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(`tab-${tab}`).classList.add('active');
        }
        init();
    </script>
</body>
</html>